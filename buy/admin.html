<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wholesale Inventory Admin | SecondHandCell</title>
    <link rel="icon" href="/favicon/favicon.ico" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
    />
    <style>
        body {
            background: linear-gradient(160deg, rgba(2, 6, 23, 0.96), rgba(15, 23, 42, 0.98));
        }
    </style>
</head>
<body class="min-h-screen text-slate-100">
    <div id="notificationBar" class="fixed inset-x-0 top-0 z-40 hidden px-4 py-3 text-sm">
        <div class="mx-auto flex max-w-4xl items-center justify-between rounded-2xl px-4 py-3">
            <span id="notificationMessage" class="font-medium"></span>
            <button
                type="button"
                id="dismissNotification"
                class="rounded-full bg-white/10 px-3 py-1 text-xs uppercase tracking-[0.2em] text-white/90 transition hover:bg-white/20"
            >
                Close
            </button>
        </div>
    </div>

    <header class="border-b border-white/10 bg-slate-950/80 backdrop-blur">
        <div class="mx-auto flex max-w-6xl flex-wrap items-center justify-between gap-4 px-6 py-6">
            <div>
                <p class="text-xs uppercase tracking-[0.4em] text-emerald-200/80">SecondHandCell · Admin</p>
                <h1 class="text-2xl font-semibold text-slate-50">Wholesale inventory control</h1>
            </div>
            <div class="flex flex-wrap items-center gap-3 text-sm">
                <a href="/buy/" class="rounded-full border border-white/10 px-4 py-2 font-medium text-slate-200 transition hover:border-emerald-400 hover:text-emerald-200">
                    <i class="fa-solid fa-arrow-left mr-2"></i>Back to buyer view
                </a>
                <button id="resetInventory" class="rounded-full border border-rose-400/60 px-4 py-2 font-semibold text-rose-200 transition hover:bg-rose-500/10">
                    Reset to defaults
                </button>
            </div>
        </div>
    </header>

    <main class="mx-auto flex max-w-6xl flex-col gap-12 px-6 py-12">
        <section>
            <h2 class="text-xl font-semibold text-slate-50">At a glance</h2>
            <div class="mt-5 grid gap-5 sm:grid-cols-2 lg:grid-cols-4" id="metricCards"></div>
        </section>

        <section class="space-y-6">
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div>
                    <h2 class="text-xl font-semibold text-slate-50">Device &amp; grade matrix</h2>
                    <p class="text-sm text-slate-300/80">Update stock levels, rename grade labels, or adjust asking prices for each SKU you own.</p>
                </div>
                <p class="text-xs text-slate-500">Changes are saved to your browser and power the /buy page instantly.</p>
            </div>
            <div class="overflow-hidden rounded-3xl border border-white/10 bg-slate-900/70">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-white/10 text-left text-sm">
                        <thead class="bg-white/5 text-xs uppercase tracking-[0.3em] text-slate-300">
                            <tr>
                                <th class="px-5 py-4">Device</th>
                                <th class="px-5 py-4">Grade label</th>
                                <th class="px-5 py-4">Stock</th>
                                <th class="px-5 py-4">Asking price</th>
                                <th class="px-5 py-4">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryTableBody" class="divide-y divide-white/5 text-slate-200"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section class="rounded-3xl border border-white/10 bg-slate-900/60 p-8">
            <div class="flex flex-wrap items-center justify-between gap-4">
                <div>
                    <h2 class="text-xl font-semibold text-slate-50">Add a new device</h2>
                    <p class="text-sm text-slate-300/80">Define the SKU once and keep grades updated as stock moves through your warehouse.</p>
                </div>
                <button id="addGradeRow" class="rounded-full border border-emerald-400/60 px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-emerald-200 transition hover:bg-emerald-400/10">
                    <i class="fa-solid fa-plus mr-2"></i>Add grade row
                </button>
            </div>
            <form id="addDeviceForm" class="mt-6 space-y-6 text-sm">
                <div class="grid gap-4 sm:grid-cols-2">
                    <label class="font-medium text-slate-300">Brand
                        <input required name="brand" class="mt-2 w-full rounded-2xl border border-white/10 bg-slate-950 px-4 py-3 text-slate-100 focus:border-emerald-400 focus:outline-none" placeholder="Apple" />
                    </label>
                    <label class="font-medium text-slate-300">Model
                        <input required name="model" class="mt-2 w-full rounded-2xl border border-white/10 bg-slate-950 px-4 py-3 text-slate-100 focus:border-emerald-400 focus:outline-none" placeholder="iPhone 14" />
                    </label>
                </div>
                <div class="grid gap-4 sm:grid-cols-2">
                    <label class="font-medium text-slate-300">Storage &amp; variant
                        <input required name="storage" class="mt-2 w-full rounded-2xl border border-white/10 bg-slate-950 px-4 py-3 text-slate-100 focus:border-emerald-400 focus:outline-none" placeholder="128GB · Midnight" />
                    </label>
                    <label class="font-medium text-slate-300">Tagline (optional)
                        <input name="tagline" class="mt-2 w-full rounded-2xl border border-white/10 bg-slate-950 px-4 py-3 text-slate-100 focus:border-emerald-400 focus:outline-none" placeholder="Unlocked GSM/CDMA" />
                    </label>
                </div>
                <label class="block font-medium text-slate-300">Image URL (optional)
                    <input name="image" class="mt-2 w-full rounded-2xl border border-white/10 bg-slate-950 px-4 py-3 text-slate-100 focus:border-emerald-400 focus:outline-none" placeholder="https://..." />
                </label>
                <div>
                    <p class="text-xs uppercase tracking-[0.3em] text-slate-400">Grades</p>
                    <div id="gradeEntryList" class="mt-4 space-y-4"></div>
                </div>
                <div class="flex flex-wrap items-center gap-3">
                    <button type="submit" class="rounded-full bg-emerald-500 px-6 py-3 text-sm font-semibold text-slate-950 transition hover:bg-emerald-400">
                        Save device
                    </button>
                    <button type="reset" class="rounded-full border border-white/10 px-4 py-3 text-sm font-medium text-slate-300 transition hover:border-emerald-400 hover:text-emerald-200">
                        Clear form
                    </button>
                </div>
            </form>
        </section>
    </main>

    <footer class="border-t border-white/10 bg-slate-950/70">
        <div class="mx-auto flex max-w-6xl flex-col gap-4 px-6 py-6 text-xs text-slate-400 sm:flex-row sm:items-center sm:justify-between">
            <p>Inventory data is stored locally in your browser under <code>wholesaleInventoryV1</code>.</p>
            <p class="text-slate-500">Questions? <a href="mailto:wholesale@secondhandcell.com" class="text-emerald-300 underline">Email the wholesale desk</a>.</p>
        </div>
    </footer>

    <script>
        (function () {
            const storageKey = "wholesaleInventoryV1";
            const defaultInventory = [
                {
                    id: "iphone-14-128",
                    brand: "Apple",
                    model: "iPhone 14",
                    storage: "128GB · Midnight",
                    tagline: "Unlocked GSM/CDMA — 12-month warranty",
                    image: "https://images.unsplash.com/photo-1661961110671-80d19bca82d5?auto=format&fit=crop&w=600&q=80",
                    grades: {
                        A: { label: "Like New", stock: 42, price: 525 },
                        B: { label: "Light Wear", stock: 63, price: 495 },
                        C: { label: "Heavy Wear", stock: 18, price: 435 },
                        F: { label: "For Parts", stock: 9, price: 160 }
                    }
                },
                {
                    id: "iphone-13-pro-256",
                    brand: "Apple",
                    model: "iPhone 13 Pro",
                    storage: "256GB · Graphite",
                    tagline: "Includes MagSafe + OEM accessories on request",
                    image: "https://images.unsplash.com/photo-1611472173362-3f53db8bbcbb?auto=format&fit=crop&w=600&q=80",
                    grades: {
                        A: { label: "Retail Ready", stock: 28, price: 610 },
                        B: { label: "Refurbished", stock: 51, price: 565 },
                        C: { label: "Value", stock: 14, price: 475 }
                    }
                },
                {
                    id: "s23-128",
                    brand: "Samsung",
                    model: "Galaxy S23",
                    storage: "128GB · Phantom Black",
                    tagline: "North American variant with 12-month warranty",
                    image: "https://images.unsplash.com/photo-1674710645957-9fef8a329565?auto=format&fit=crop&w=600&q=80",
                    grades: {
                        A: { label: "Pristine", stock: 36, price: 490 },
                        B: { label: "Gently Used", stock: 44, price: 455 },
                        C: { label: "Operational", stock: 22, price: 390 }
                    }
                },
                {
                    id: "ipad-air-5",
                    brand: "Apple",
                    model: "iPad Air 5",
                    storage: "256GB · Wi-Fi",
                    tagline: "Includes OEM USB-C cable and charger",
                    image: "https://images.unsplash.com/photo-1610792516305-cb4c9c736d72?auto=format&fit=crop&w=600&q=80",
                    grades: {
                        A: { label: "Like New", stock: 24, price: 540 },
                        B: { label: "Retail Return", stock: 33, price: 505 },
                        F: { label: "Housing/Battery", stock: 11, price: 180 }
                    }
                }
            ];

            const notificationBar = document.getElementById("notificationBar");
            const notificationMessage = document.getElementById("notificationMessage");
            const dismissNotification = document.getElementById("dismissNotification");
            const metricCards = document.getElementById("metricCards");
            const inventoryTableBody = document.getElementById("inventoryTableBody");
            const resetInventoryButton = document.getElementById("resetInventory");
            const addGradeRowButton = document.getElementById("addGradeRow");
            const gradeEntryList = document.getElementById("gradeEntryList");
            const addDeviceForm = document.getElementById("addDeviceForm");
            const gradeLetters = ["A", "B", "C", "F"];

            const storedInventory = (() => {
                try {
                    const value = localStorage.getItem(storageKey);
                    const parsed = value ? JSON.parse(value) : null;
                    return Array.isArray(parsed) && parsed.length ? parsed : null;
                } catch (error) {
                    console.warn("Unable to read inventory", error);
                    return null;
                }
            })();

            function persistInventory() {
                try {
                    localStorage.setItem(storageKey, JSON.stringify(inventory));
                } catch (error) {
                    console.warn("Unable to save inventory", error);
                }
            }

            let inventory = storedInventory || JSON.parse(JSON.stringify(defaultInventory));
            if (!storedInventory) {
                persistInventory();
            }

            function showNotification(message, tone = "info") {
                const toneConfig = {
                    info: "bg-slate-800/95 border border-white/10",
                    success: "bg-emerald-600/10 border border-emerald-400/40 text-emerald-100",
                    warning: "bg-amber-600/20 border border-amber-400/40 text-amber-100",
                    error: "bg-rose-600/20 border border-rose-400/40 text-rose-100"
                };
                notificationMessage.textContent = message;
                notificationBar.className = `fixed inset-x-0 top-0 z-40 px-4 py-3 text-sm ${toneConfig[tone] || toneConfig.info}`;
                notificationBar.classList.remove("hidden");
            }

            function hideNotification() {
                notificationBar.classList.add("hidden");
            }

            dismissNotification.addEventListener("click", hideNotification);

            function formatCurrency(value) {
                return new Intl.NumberFormat("en-US", { style: "currency", currency: "USD", maximumFractionDigits: 0 }).format(value);
            }

            function calculateTotals() {
                const totals = {
                    sku: inventory.length,
                    units: 0,
                    askingValue: 0,
                    gradeMix: { A: 0, B: 0, C: 0, F: 0 }
                };

                inventory.forEach((device) => {
                    Object.entries(device.grades || {}).forEach(([gradeKey, grade]) => {
                        totals.units += grade.stock;
                        totals.askingValue += grade.stock * grade.price;
                        if (totals.gradeMix[gradeKey] !== undefined) {
                            totals.gradeMix[gradeKey] += grade.stock;
                        }
                    });
                });
                return totals;
            }

            function renderMetrics() {
                const totals = calculateTotals();
                const gradeEntries = Object.entries(totals.gradeMix)
                    .filter(([, qty]) => qty > 0)
                    .map(([grade, qty]) => `<span class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs">${grade}: ${qty}</span>`)
                    .join(" ");

                metricCards.innerHTML = `
                    <div class="rounded-3xl border border-white/10 bg-slate-900/70 p-6">
                        <p class="text-xs uppercase tracking-[0.3em] text-emerald-200">SKUs</p>
                        <p class="mt-3 text-3xl font-semibold text-slate-50">${totals.sku}</p>
                        <p class="mt-2 text-xs text-slate-400">Unique devices currently active</p>
                    </div>
                    <div class="rounded-3xl border border-white/10 bg-slate-900/70 p-6">
                        <p class="text-xs uppercase tracking-[0.3em] text-emerald-200">Total units</p>
                        <p class="mt-3 text-3xl font-semibold text-slate-50">${totals.units}</p>
                        <p class="mt-2 text-xs text-slate-400">Across all grades</p>
                    </div>
                    <div class="rounded-3xl border border-white/10 bg-slate-900/70 p-6">
                        <p class="text-xs uppercase tracking-[0.3em] text-emerald-200">Asking value</p>
                        <p class="mt-3 text-3xl font-semibold text-slate-50">${formatCurrency(totals.askingValue)}</p>
                        <p class="mt-2 text-xs text-slate-400">Value if sold at current pricing</p>
                    </div>
                    <div class="rounded-3xl border border-white/10 bg-slate-900/70 p-6">
                        <p class="text-xs uppercase tracking-[0.3em] text-emerald-200">Grade mix</p>
                        <p class="mt-3 flex flex-wrap gap-2">${gradeEntries || "<span class=\"text-xs text-slate-500\">No grades defined</span>"}</p>
                    </div>
                `;
            }

            function renderInventoryTable() {
                const rows = [];
                inventory.forEach((device) => {
                    const gradeKeys = Object.keys(device.grades || {});
                    gradeKeys.forEach((gradeKey, index) => {
                        const grade = device.grades[gradeKey];
                        rows.push(`
                            <tr data-device-id="${device.id}" data-grade="${gradeKey}" class="align-top">
                                <td class="px-5 py-4">
                                    <p class="text-xs uppercase tracking-[0.3em] text-emerald-200/80">${device.brand}</p>
                                    <p class="text-base font-semibold text-slate-50">${device.model}</p>
                                    <p class="text-xs text-slate-400">${device.storage}</p>
                                    <p class="mt-2 inline-flex items-center gap-2 rounded-full border border-white/10 px-3 py-1 text-xs text-slate-300">
                                        Grade ${gradeKey}
                                        <span class="h-1.5 w-1.5 rounded-full bg-emerald-400"></span>
                                    </p>
                                    ${index === 0
                                        ? `<button data-action="remove-device" class="mt-3 text-xs text-rose-300 underline underline-offset-2 transition hover:text-rose-200">Remove device</button>`
                                        : ""}
                                </td>
                                <td class="px-5 py-4">
                                    <input
                                        type="text"
                                        value="${grade.label}"
                                        data-field="label"
                                        class="w-full rounded-2xl border border-white/10 bg-slate-950 px-3 py-2 text-sm text-slate-100 focus:border-emerald-400 focus:outline-none"
                                    />
                                </td>
                                <td class="px-5 py-4">
                                    <input
                                        type="number"
                                        min="0"
                                        value="${grade.stock}"
                                        data-field="stock"
                                        class="w-28 rounded-2xl border border-white/10 bg-slate-950 px-3 py-2 text-right text-sm text-slate-100 focus:border-emerald-400 focus:outline-none"
                                    />
                                </td>
                                <td class="px-5 py-4">
                                    <input
                                        type="number"
                                        min="0"
                                        step="1"
                                        value="${grade.price}"
                                        data-field="price"
                                        class="w-32 rounded-2xl border border-white/10 bg-slate-950 px-3 py-2 text-right text-sm text-slate-100 focus:border-emerald-400 focus:outline-none"
                                    />
                                </td>
                                <td class="px-5 py-4">
                                    <div class="flex flex-wrap gap-2">
                                        <button data-action="save-grade" class="rounded-full bg-emerald-500 px-4 py-2 text-xs font-semibold text-slate-950 transition hover:bg-emerald-400">Save</button>
                                        <button data-action="remove-grade" class="rounded-full border border-white/10 px-4 py-2 text-xs font-medium text-slate-300 transition hover:border-rose-400 hover:text-rose-200">Remove grade</button>
                                    </div>
                                </td>
                            </tr>
                        `);
                    });
                });

                if (!rows.length) {
                    inventoryTableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="px-5 py-6 text-center text-sm text-slate-400">No devices configured yet. Use the form below to add your first SKU.</td>
                        </tr>
                    `;
                } else {
                    inventoryTableBody.innerHTML = rows.join("");
                }
            }

            function slugify(value) {
                return value
                    .toString()
                    .toLowerCase()
                    .replace(/[^a-z0-9]+/g, "-")
                    .replace(/(^-|-$)+/g, "")
                    .substring(0, 50);
            }

            function createGradeEntryRow(initial = {}) {
                const usedGrades = Array.from(gradeEntryList.querySelectorAll("[data-grade-select]")).map((select) => select.value);
                const defaultGrade = initial.grade || gradeLetters.find((grade) => !usedGrades.includes(grade)) || gradeLetters[0];
                const row = document.createElement("div");
                row.className = "grid gap-3 rounded-2xl border border-white/10 bg-slate-950/80 p-4 sm:grid-cols-[120px_1fr_1fr_40px] sm:items-end";
                row.dataset.gradeEntry = "true";
                row.innerHTML = `
                    <label class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-400">
                        Grade
                        <select class="mt-2 w-full rounded-xl border border-white/10 bg-slate-950 px-3 py-2 text-sm text-slate-100 focus:border-emerald-400 focus:outline-none" data-grade-select>
                            ${gradeLetters
                                .map((grade) => `<option value="${grade}" ${defaultGrade === grade ? "selected" : ""}>${grade}</option>`)
                                .join("")}
                        </select>
                    </label>
                    <label class="text-xs text-slate-300">
                        Label
                        <input type="text" value="${initial.label || ""}" data-grade-label class="mt-2 w-full rounded-xl border border-white/10 bg-slate-950 px-3 py-2 text-sm text-slate-100 focus:border-emerald-400 focus:outline-none" placeholder="Like New" />
                    </label>
                    <label class="text-xs text-slate-300">
                        Stock
                        <input type="number" min="0" value="${initial.stock ?? ""}" data-grade-stock class="mt-2 w-full rounded-xl border border-white/10 bg-slate-950 px-3 py-2 text-sm text-slate-100 focus:border-emerald-400 focus:outline-none" placeholder="25" />
                    </label>
                    <div class="flex items-end justify-end">
                        <button type="button" data-remove-grade-row class="rounded-full border border-white/10 px-3 py-2 text-xs text-slate-300 transition hover:border-rose-400 hover:text-rose-200">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    </div>
                    <label class="text-xs text-slate-300 sm:col-span-4">
                        Asking price (per unit)
                        <input type="number" min="0" step="1" value="${initial.price ?? ""}" data-grade-price class="mt-2 w-full rounded-xl border border-white/10 bg-slate-950 px-3 py-2 text-sm text-slate-100 focus:border-emerald-400 focus:outline-none" placeholder="500" />
                    </label>
                `;
                gradeEntryList.appendChild(row);
            }

            function ensureGradeRows() {
                if (!gradeEntryList.querySelector("[data-grade-entry]")) {
                    createGradeEntryRow();
                }
            }

            gradeEntryList.addEventListener("click", (event) => {
                const button = event.target.closest("[data-remove-grade-row]");
                if (!button) return;
                const row = button.closest("[data-grade-entry]");
                row.remove();
                ensureGradeRows();
            });

            addGradeRowButton.addEventListener("click", () => {
                createGradeEntryRow();
            });

            addDeviceForm.addEventListener("submit", (event) => {
                event.preventDefault();
                const formData = new FormData(addDeviceForm);
                const brand = formData.get("brand").trim();
                const model = formData.get("model").trim();
                const storage = formData.get("storage").trim();
                const tagline = formData.get("tagline").trim();
                const image = formData.get("image").trim();

                if (!brand || !model || !storage) {
                    showNotification("Brand, model, and storage are required.", "warning");
                    return;
                }

                const grades = {};
                const gradeRows = gradeEntryList.querySelectorAll("[data-grade-entry]");
                if (!gradeRows.length) {
                    showNotification("Add at least one grade for the device.", "warning");
                    return;
                }

                let hasError = false;
                gradeRows.forEach((row) => {
                    const gradeKey = row.querySelector("[data-grade-select]").value;
                    const label = row.querySelector("[data-grade-label]").value.trim();
                    const stock = parseInt(row.querySelector("[data-grade-stock]").value, 10);
                    const price = parseFloat(row.querySelector("[data-grade-price]").value);

                    if (!label || Number.isNaN(stock) || Number.isNaN(price)) {
                        hasError = true;
                        return;
                    }
                    if (grades[gradeKey]) {
                        hasError = true;
                        showNotification(`Duplicate grade ${gradeKey}. Each grade can only be used once.`, "warning");
                        return;
                    }
                    grades[gradeKey] = { label, stock: Math.max(0, stock), price: Math.max(0, Math.round(price * 100) / 100) };
                });

                if (hasError) {
                    return;
                }

                const idBase = `${slugify(brand)}-${slugify(model)}`;
                let uniqueId = idBase;
                let suffix = 1;
                while (inventory.some((item) => item.id === uniqueId)) {
                    uniqueId = `${idBase}-${suffix++}`;
                }

                const newDevice = {
                    id: uniqueId,
                    brand,
                    model,
                    storage,
                    tagline,
                    image,
                    grades
                };

                inventory.push(newDevice);
                persistInventory();
                renderInventoryTable();
                renderMetrics();
                addDeviceForm.reset();
                gradeEntryList.innerHTML = "";
                ensureGradeRows();
                showNotification(`${model} added to inventory.`, "success");
            });

            addDeviceForm.addEventListener("reset", () => {
                setTimeout(() => {
                    gradeEntryList.innerHTML = "";
                    ensureGradeRows();
                });
            });

            inventoryTableBody.addEventListener("click", (event) => {
                const button = event.target.closest("[data-action]");
                if (!button) return;
                const row = button.closest("tr[data-device-id]");
                const deviceId = row.dataset.deviceId;
                const gradeKey = row.dataset.grade;
                const deviceIndex = inventory.findIndex((item) => item.id === deviceId);
                if (deviceIndex === -1) return;

                if (button.dataset.action === "save-grade") {
                    const labelInput = row.querySelector("[data-field=label]");
                    const stockInput = row.querySelector("[data-field=stock]");
                    const priceInput = row.querySelector("[data-field=price]");
                    const label = labelInput.value.trim();
                    const stock = parseInt(stockInput.value, 10);
                    const price = parseFloat(priceInput.value);

                    if (!label || Number.isNaN(stock) || Number.isNaN(price)) {
                        showNotification("Please enter valid label, stock, and price values.", "warning");
                        return;
                    }

                    inventory[deviceIndex].grades[gradeKey] = {
                        label,
                        stock: Math.max(0, stock),
                        price: Math.max(0, Math.round(price * 100) / 100)
                    };
                    persistInventory();
                    renderMetrics();
                    renderInventoryTable();
                    showNotification(`Saved updates for ${inventory[deviceIndex].model} grade ${gradeKey}.`, "success");
                }

                if (button.dataset.action === "remove-grade") {
                    delete inventory[deviceIndex].grades[gradeKey];
                    if (!Object.keys(inventory[deviceIndex].grades).length) {
                        inventory.splice(deviceIndex, 1);
                    }
                    persistInventory();
                    renderMetrics();
                    renderInventoryTable();
                    showNotification(`Removed grade ${gradeKey}.`, "info");
                }

                if (button.dataset.action === "remove-device") {
                    inventory.splice(deviceIndex, 1);
                    persistInventory();
                    renderMetrics();
                    renderInventoryTable();
                    showNotification("Device removed from inventory.", "info");
                }
            });

            resetInventoryButton.addEventListener("click", () => {
                inventory = JSON.parse(JSON.stringify(defaultInventory));
                persistInventory();
                renderMetrics();
                renderInventoryTable();
                showNotification("Inventory reset to default dataset.", "info");
            });

            function init() {
                renderMetrics();
                renderInventoryTable();
                ensureGradeRows();
            }

            init();
        })();
    </script>
</body>
</html>
