<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>SecondHandCell - Google Pixel Buyback</title>
    <link rel="icon" href="/favicon/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9evSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-W3BM2JC8');</script>
    <!-- End Google Tag Manager -->

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8fafc; /* Tailwind slate-50 */
            color: #1e293b; /* Tailwind slate-800 */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .user-monogram {
            display: flex; align-items: center; justify-content: center;
            width: 2.5rem; height: 2.5rem;
            border-radius: 9999px;
            background-color: #dbeafe; color: #1d4ed8; /* blue-100, blue-700 */
            font-weight: 700; font-size: 1.125rem;
            cursor: pointer; user-select: none;
        }
        .auth-dropdown {
            position: absolute; right: 0; margin-top: 0.5rem;
            width: 12rem; background-color: white;
            border-radius: 0.375rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding-top: 0.25rem; padding-bottom: 0.25rem;
            z-index: 50;
        }
        .modal {
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
            opacity: 0; visibility: hidden;
        }
        .modal.is-visible {
            opacity: 1; visibility: visible;
        }
        .modal-content {
            transform: translateY(-20px);
            transition: transform 0.3s ease-out;
        }
        .modal.is-visible .modal-content {
            transform: translateY(0);
        }
        .btn-google-style {
            display: flex; align-items: center; justify-content: center;
            width: 100%; background-color: white; color: #475569;
            padding: 0.75rem 1rem; border-radius: 0.5rem;
            border: 1px solid #cbd5e1; font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            cursor: pointer;
        }
        .btn-google-style:hover { background-color: #f8fafc; }
        .btn-dark-slate {
            width: 100%; background-color: #1e293b; color: white;
            padding: 0.75rem 1rem; border-radius: 0.5rem;
            font-weight: 600; transition: all 0.3s ease;
            border: none; cursor: pointer;
        }
        .btn-dark-slate:hover { background-color: #0f172a; }
         .btn-red-logout {
            display: block; width: 100%; text-align: left;
            padding: 0.5rem 1rem; font-size: 0.875rem; color: #dc2626;
            background-color: transparent; border: none;
            transition: background-color 0.2s ease; cursor: pointer;
        }
        .btn-red-logout:hover { background-color: #fef2f2; }
        .prose { max-width: 65ch; color: #334155; }
        .prose h2 { font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5em; margin-bottom: 0.5em; }
        .prose p, .prose ul { margin-bottom: 1em; }
        .prose ul { list-style-position: inside; padding-left: 1em; }
        .prose li { margin-bottom: 0.5em; }
    </style>
</head>
<body class="bg-slate-50 flex flex-col min-h-screen">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W3BM2JC8"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-sm">
        <div class="container mx-auto px-4 py-3 flex items-center md:py-5">
            <div class="flex-1 flex justify-start items-center logo-container-left">
                <a href="/index.html" class="h-12 md:h-20 w-auto">
                    <img src="https://raw.githubusercontent.com/ToratYosef/BuyBacking/refs/heads/main/assets/logo.png" alt="SecondHandCell Logo" class="h-full w-auto" onerror="this.onerror=null;this.src='https://placehold.co/200x64/ffffff/1e293b?text=SecondHandCell';">
                </a>
            </div>
            <div class="flex-none flex-col items-center flex-1 logo-text-container-center">
                <div class="text-xl md:text-2xl font-extrabold whitespace-nowrap">
                    <span class="text-black">Second</span><span style="color: #54a929;">HandCell</span>
                </div>
                <p class="text-[0.6rem] md:text-sm -mt-1 whitespace-nowrap" style="color: #54a929;">Turn Your Old<span class="text-black"> Phone Into Cash!</span></p>
            </div>
            <nav class="flex-1 flex justify-end items-center space-x-4">
                <div id="authStatusContainer" class="relative inline-block">
                    <a href="#" id="loginNavBtn" class="bg-blue-600 text-white px-2.5 py-1.5 md:px-4 md:py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors duration-300 shadow-sm text-xs md:text-base">Login/Sign Up</a>
                    <div id="userMonogram" class="user-monogram hidden"></div>
                    <div id="authDropdown" class="auth-dropdown hidden">
                        <a href="https://secondhandcell.com/my-account.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">My Account</a>
                        <button id="logoutBtn" class="btn-red-logout">Logout</button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="flex-grow flex items-center justify-center">
        <div class="container mx-auto px-4 py-12 text-center">
            <div class="bg-white p-8 md:p-12 rounded-2xl shadow-xl max-w-2xl mx-auto">
                <div class="mx-auto mb-6 w-20 h-20 rounded-full bg-blue-100 flex items-center justify-center text-4xl text-blue-500">
                    <i class="fa-solid fa-mobile-screen-button"></i>
                </div>
                <h1 class="text-3xl md:text-4xl font-extrabold text-slate-800 mb-4">Sorry, we don't accept Google Pixels at this time.</h1>
                <p class="text-slate-600 text-lg mb-8">
                    Our buyback program is not currently available for Google Pixels. We are constantly updating our services, so please check back in the future!
                </p>
                <button id="chooseAnotherDeviceBtn" class="bg-blue-600 text-white px-8 py-4 rounded-full font-bold text-lg shadow-lg hover:bg-blue-700 transition-transform duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">
                    Choose another device
                </button>
            </div>
        </div>
    </main>

    <footer class="bg-slate-800 text-white">
        <div class="container mx-auto px-4 py-12">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2 grid grid-cols-1 sm:grid-cols-3 gap-8">
                    <div><h3 class="text-xl font-bold mb-4">SecondHandCell</h3><p class="text-slate-400">Your trusted partner for selling used tech. Quick quotes, fair prices, and hassle-free service.</p></div>
                    <div><h3 class="text-xl font-bold mb-4">Quick Links</h3><ul class="space-y-2"><li><a href="index.html" class="text-slate-400 hover:text-white transition duration-300">Home</a></li><li><a href="#" id="aboutUsLink" class="text-slate-400 hover:text-white transition duration-300">About Us</a></li><li><a href="#" id="privacyPolicyLink" class="text-slate-400 hover:text-white transition duration-300">Privacy Policy</a></li><li><a href="#" id="termsAndConditionsLinkFooter" class="text-slate-400 hover:text-white transition duration-300">Terms & Conditions</a></li></ul></div>
                    <div><h3 class="text-xl font-bold mb-4">Contact Us</h3><p class="text-slate-400">Email: support@secondhandcell.com</p></div>
                </div>
                <div class="bg-slate-700 p-6 rounded-lg">
                    <h3 class="text-xl font-bold mb-2 text-white">Stay Updated</h3>
                    <p class="text-slate-300 mb-4">Sign up for promos, price increases, and more!</p>
                    <form id="footerEmailSignupForm" class="flex flex-col sm:flex-row gap-2">
                        <label for="footerPromoEmail" class="sr-only">Email Address</label>
                        <input type="email" id="footerPromoEmail" placeholder="Enter your email" class="w-full flex-grow border border-slate-400 bg-slate-800 text-white p-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors duration-300 shadow-sm">Sign Up</button>
                    </form>
                    <div id="footerSignupMessage" class="mt-3 text-sm text-center"></div>
                </div>
            </div>
                        <!-- Trust & accreditation badges -->
            <div class="mt-8">
                <div class="flex flex-wrap items-center justify-center gap-6 sm:flex-row sm:justify-center sm:gap-8 lg:justify-start">
                    <a href="https://www.sellcell.com/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center">
                        <img src="https://c9ac71a8282e1fecd95e-f07dbcddcacf0d4c572ea7178ee6902d.ssl.cf2.rackcdn.com/assets/images/share/sellcell-accredited-buyer.png" width="150" height="107" alt="SellCell Accredited Buyer" loading="lazy" class="h-20 w-auto object-contain">
                    </a>
                    <a href="https://www.trustpilot.com/evaluate/secondhandcell.com" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center">
                        <img src="https://cdn.trustpilot.net/brand-assets/4.1.0/stars/stars-5.png" alt="Trustpilot 5 star rating" loading="lazy" class="h-12 w-auto object-contain">
                    </a>
                </div>
            </div>
            <div class="border-t border-slate-700 mt-8 pt-6 text-center text-slate-400 text-sm"><p>&copy; 2025 SecondHandCell. All rights reserved.</p></div>
        </div>
    </footer>

    <!-- Login/Signup Modal -->
    <div id="loginModal" class="modal fixed inset-0 z-[1001] flex items-center justify-center p-4" style="background-color: rgba(0, 0, 0, 0.6);">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-md p-6 relative modal-content">
            <button class="close-modal-btn absolute top-3 right-3 text-slate-400 hover:text-slate-600"><i class="fa-solid fa-xmark text-xl"></i></button>
            <h2 class="text-2xl font-bold text-slate-800 mb-6 text-center">Your SecondHandCell Account</h2>
            <div class="flex border-b border-slate-200 mb-6">
                <button id="loginTabBtn" class="flex-1 py-3 text-center text-lg font-medium border-b-2">Login</button>
                <button id="signupTabBtn" class="flex-1 py-3 text-center text-lg font-medium border-b-2">Sign Up</button>
            </div>
            <form id="loginForm" class="space-y-4">
                <p class="text-slate-600 text-center">Log in to continue.</p>
                <button type="button" id="googleLoginBtn" class="btn-google-style">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google icon" class="w-5 h-5 mr-3">Login with Google
                </button>
                <div class="text-center text-slate-500 relative my-4">
                    <span class="bg-white px-2 z-10 relative">or</span>
                    <hr class="absolute inset-0 top-1/2 border-t">
                </div>
                <input type="email" id="loginEmail" placeholder="Email Address" class="w-full border p-3 rounded-lg">
                <input type="password" id="loginPassword" placeholder="Password" class="w-full border p-3 rounded-lg" autocomplete="current-password">
                <button type="submit" class="btn-dark-slate">Login</button>
            </form>
            <form id="signupForm" class="space-y-4 hidden">
                <p class="text-slate-600 text-center">Create an account.</p>
                <button type="button" id="googleSignupBtn" class="btn-google-style">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google icon" class="w-5 h-5 mr-3">Sign Up with Google
                </button>
                <div class="text-center text-slate-500 relative my-4">
                    <span class="bg-white px-2 z-10 relative">or</span>
                    <hr class="absolute inset-0 top-1/2 border-t">
                </div>
                <input type="text" id="signupName" placeholder="Full Name" class="w-full border p-3 rounded-lg">
                <input type="email" id="signupEmail" placeholder="Email Address" class="w-full border p-3 rounded-lg">
                <input type="password" id="signupPassword" placeholder="Password" class="w-full border p-3 rounded-lg" autocomplete="new-password">
                <button type="submit" class="btn-dark-slate">Sign Up</button>
            </form>
            <div id="authMessage" class="mt-4 p-3 rounded-lg text-sm text-center hidden"></div>
        </div>
    </div>

    <!-- About Us Modal -->
    <div id="aboutUsModal" class="modal fixed inset-0 z-[1001] flex items-center justify-center p-4">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-full max-w-2xl p-6 relative">
            <button class="close-modal-btn absolute top-3 right-3 text-slate-400 hover:text-slate-600"><i class="fa-solid fa-xmark text-xl"></i></button>
            <h2 class="text-2xl font-bold text-slate-800 mb-4">About Us</h2>
            <p class="text-slate-600">Welcome to SecondHandCell, where we believe in giving old tech a new life. Our mission is to make selling your used devices as simple, safe, and rewarding as possible. We offer competitive prices, a hassle-free process, and a commitment to sustainability.</p>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacyPolicyModal" class="modal fixed inset-0 z-[1001] flex items-center justify-center p-4">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-full max-w-3xl p-8 relative">
            <button class="close-modal-btn absolute top-4 right-4 text-slate-400 hover:text-slate-600"><i class="fa-solid fa-xmark text-xl"></i></button>
            <div class="prose max-h-[80vh] overflow-y-auto pr-4">
                <h2 class="text-2xl font-bold text-slate-800 mb-4">Privacy Policy</h2>
                <p><strong>Last Updated: August 29, 2025</strong></p>
                <p>SecondHandCell ("we," "us," or "our") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you visit our website.</p>
                <h3>Information We Collect</h3>
                <p>We may collect personal information from you such as your name, email address, postal address, phone number, and payment information (e.g., Venmo, Zelle, or PayPal details). We also collect information about the device you are selling, including its model, serial number, and condition.</p>
                <h3>How We Use Your Information </h3>
                <p>We use the information we collect to: process your transactions; send you shipping kits and communicate about your order status; process payments; respond to customer service requests; send you marketing and promotional communications, with your consent.</p>
                <h3>Data Security and Wiping</h3>
                <p>We implement a variety of security measures to maintain the safety of your personal information. All devices sold to us undergo a certified, multi-pass data-wiping process to ensure your personal information is professionally and permanently erased.</p>
                <h3>Disclosure of Your Information</h3>
                <p>We do not sell, trade, or otherwise transfer to outside parties your Personally Identifiable Information except to trusted third parties who assist us in operating our website, conducting our business, or servicing you (such as shipping carriers), so long as those parties agree to keep this information confidential.</p>
                <h3>Your Consent</h3>
                <p>By using our site, you consent to our website's privacy policy.</p>
            </div>
        </div>
    </div>

    <!-- Terms and Conditions Modal -->
    <div id="termsAndConditionsModal" class="modal fixed inset-0 z-[1001] flex items-center justify-center p-4">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-full max-w-3xl p-8 relative">
            <button class="close-modal-btn absolute top-4 right-4 text-slate-400 hover:text-slate-600"><i class="fa-solid fa-xmark text-xl"></i></button>
            <div class="prose max-h-[80vh] overflow-y-auto pr-4">
                <h2 class="text-2xl font-bold text-slate-800 mb-4">Terms & Conditions</h2>
                <p><strong>Last Updated: August 29, 2025</strong></p>
                <p>Please read these Terms and Conditions ("Terms") carefully before using the SecondHandCell website ("Service") operated by us.</p>
                <h3>1. User Obligations</h3>
                <p>By using the Service, you represent and warrant that:</p>
                <ul><li>You are the legal owner of the device you are selling.</li><li>The device is not reported as lost or stolen, and its IMEI is not blacklisted.</li><li>The device has no outstanding balance and is not subject to any financing or lease agreement.</li><li>All information you provide about the device is accurate and truthful.</li></ul>
                <h3>2. The Offer Process</h3>
                <ul><li>The initial quote provided on our website is an estimate based on the information you provide.</li><li>Upon receiving your device, we will conduct a thorough inspection. If the device's condition differs from what was described, we will issue a revised offer via email.</li><li><strong>You have seven (7) days to accept or decline the revised offer. If you do not respond within this 7-day period, the revised offer will be automatically accepted on your behalf, and we will proceed with payment.</strong></li><li>Once an offer (initial or revised) is accepted, it is locked in and final. There is no option for a re-offer or to have the device returned.</li></ul>
                <h3>3. Shipping and Risk of Loss</h3>
                <p>We provide a prepaid shipping label and materials. SecondHandCell is not responsible for any damage or loss that occurs before the device is received and scanned by our designated shipping carrier.</p>
                <h3>4. Limitation of Liability</h3>
                <p>In no event shall SecondHandCell, nor its directors, employees, partners, agents, suppliers, or affiliates, be liable for any indirect, incidental, special, consequential or punitive damages, including without limitation, loss of profits, data, use, goodwill, or other intangible losses, resulting from your access to or use of or inability to access or use the Service.</p>
                <hr class="my-6 border-t border-slate-300">
                <h3>5. Policy on Lost/Stolen Devices & Legal Compliance (New York State & NYC)</h3>
                <p>SecondHandCell is committed to operating in full compliance with all applicable laws and regulations regarding the purchase and sale of secondhand goods, particularly those concerning lost or stolen property. This section outlines our strict policy and the legal framework governing such transactions in New York State and New York City.</p>
                <h4>Laws That May Apply (NY State + NYC)</h4>
                <ul><li>**New York Penal Law § 155.05(2)(b) – Larceny by acquiring lost property:** If someone acquires lost property and does not take reasonable measures to return it, it counts as larceny.</li><li>**New York Penal Law § 165.40 – Criminal possession of stolen property in the 5th degree:** Knowingly possessing stolen property (or should reasonably know it’s stolen) is a misdemeanor.</li><li>**New York Penal Law § 165.45–165.54 – Criminal possession of stolen property (4th–1st degree):** Felonies based on the value of the stolen property. Smartphones can easily push this into felony territory if valuable.</li><li>**New York City Administrative Code § 20-272 et seq. (Secondhand Dealer Law):** Dealers in secondhand goods must:<ul><li>Keep records of all items received (including seller ID).</li><li>Provide daily reports to the NYPD of transactions (often through electronic reporting).</li><li>If police suspect an item is lost/stolen, you must hold and exhibit it to them.</li></ul></li><li>**New York City Administrative Code § 20-273:** It is unlawful to conceal, withhold, or refuse inspection of such goods.</li><li>**General Business Law (NY) GBL § 89-g and following – Regulation of pawnbrokers and secondhand dealers:** Requires keeping detailed records and prohibits resale of items flagged as stolen/lost until cleared.</li><li>**Federal Considerations (18 U.S.C. § 2315 – Possession or sale of stolen property):** If stolen goods (like phones) cross state lines or involve interstate commerce, federal law applies.</li></ul>
                <h4>Process to Handle Lost/Stolen Phones in Your Buyback</h4>
                <p>Here’s our step-by-step written policy to handle devices suspected of being lost or stolen:</p>
                <h5>Intake & Verification</h5>
                <ul><li>Every device received must be checked against:<ul><li>IMEI/serial number databases (e.g., GSMA, carrier blacklists).</li><li>Customer’s government-issued ID at time of transaction.</li></ul></li><li>Record the transaction in compliance with NYC Secondhand Dealer laws.</li></ul>
                <h5>If a Device is Flagged as Lost or Stolen</h5>
                <ul><li>Immediately set the device aside and do not refurbish, resell, or dispose of it.</li><li>Clearly label it as “On Hold – Suspected Lost/Stolen.”</li></ul>
                <h5>Customer Communication</h5>
                <ul><li>If the customer requests the item back:<ul><li>Explain: “Under New York law, we cannot return or release devices suspected to be lost or stolen. These items must be reported and may only be released by law enforcement.”</li></ul></li></ul>
                <h5>Law Enforcement Notification</h5>
                <ul><li>Report the device to the NYPD Property Clerk’s Office (or local precinct if outside NYC).</li><li>Provide transaction records, customer ID, and the device itself if requested.</li></ul>
                <h5>Outcome</h5>
                <ul><li>If police confirm the device is stolen:<ul><li>It will be seized and returned to the rightful owner or carrier.</li></ul></li><li>If cleared:<ul><li>You may proceed with processing the device as normal.</li></ul></li></ul>
                <h5>Recordkeeping</h5>
                <ul><li>Keep all paperwork of the transaction, report, and police correspondence for at least 5 years (per NYC dealer rules).</li></ul>
            </div>
        </div>
    </div>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signOut, onAuthStateChanged, signInWithPopup, GoogleAuthProvider, signInWithEmailAndPassword, createUserWithEmailAndPassword, updateProfile } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, runTransaction, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Firebase Configuration using the provided global variable
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        document.addEventListener('DOMContentLoaded', function() {
            // --- MODAL & AUTH LOGIC ---
            const modals = document.querySelectorAll('.modal');
            const openModal = (modalId) => document.getElementById(modalId)?.classList.add('is-visible');
            const closeModal = (modal) => modal.classList.remove('is-visible');

            // Event listeners for the header links and modal closing
            document.getElementById('aboutUsLink').addEventListener('click', (e) => { e.preventDefault(); openModal('aboutUsModal'); });
            document.getElementById('privacyPolicyLink').addEventListener('click', (e) => { e.preventDefault(); openModal('privacyPolicyModal'); });
            document.getElementById('termsAndConditionsLinkFooter').addEventListener('click', (e) => { e.preventDefault(); openModal('termsAndConditionsModal'); });
            
            modals.forEach(modal => {
                modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(modal); });
                modal.querySelector('.close-modal-btn')?.addEventListener('click', () => closeModal(modal));
            });

            // Login/Signup Tab Logic
            const loginTabBtn = document.getElementById('loginTabBtn');
            const signupTabBtn = document.getElementById('signupTabBtn');
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            const authMessage = document.getElementById('authMessage');

            const showTab = (tabName) => {
                authMessage.classList.add('hidden');
                [loginForm, signupForm].forEach(form => form.classList.add('hidden'));
                [loginTabBtn, signupTabBtn].forEach(btn => btn.classList.remove('border-blue-600', 'text-blue-600'));
                
                if (tabName === 'login') {
                    loginForm.classList.remove('hidden');
                    loginTabBtn.classList.add('border-blue-600', 'text-blue-600');
                } else {
                    signupForm.classList.remove('hidden');
                    signupTabBtn.classList.add('border-blue-600', 'text-blue-600');
                }
            };
            
            loginTabBtn.addEventListener('click', () => showTab('login'));
            signupTabBtn.addEventListener('click', () => showTab('signup'));

            const authStatusContainer = document.getElementById('authStatusContainer');
            const loginNavBtn = document.getElementById('loginNavBtn');
            const userMonogram = document.getElementById('userMonogram');
            const authDropdown = document.getElementById('authDropdown');
            const logoutBtn = document.getElementById('logoutBtn');
            const googleLoginBtn = document.getElementById('googleLoginBtn');
            const googleSignupBtn = document.getElementById('googleSignupBtn');
            const loginEmailInput = document.getElementById('loginEmail');
            const loginPasswordInput = document.getElementById('loginPassword');
            const signupNameInput = document.getElementById('signupName');
            const signupEmailInput = document.getElementById('signupEmail');
            const signupPasswordInput = document.getElementById('signupPassword');
            
            function showAuthMessage(msg, type = 'error') {
                authMessage.textContent = msg;
                authMessage.className = 'mt-4 p-3 rounded-lg text-sm text-center';
                if (type === 'error') {
                    authMessage.classList.add('bg-red-100', 'text-red-700');
                } else if (type === 'success') {
                    authMessage.classList.add('bg-green-100', 'text-green-700');
                }
                authMessage.classList.remove('hidden');
            }

            const googleProvider = new GoogleAuthProvider();
            const signInWithGoogle = async () => {
                try {
                    await signInWithPopup(auth, googleProvider);
                    closeModal(document.getElementById('loginModal'));
                } catch (error) {
                    showAuthMessage(error.message);
                }
            };
            googleLoginBtn.addEventListener('click', signInWithGoogle);
            googleSignupBtn.addEventListener('click', signInWithGoogle);

            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                try {
                    await signInWithEmailAndPassword(auth, loginEmailInput.value, loginPasswordInput.value);
                    closeModal(document.getElementById('loginModal'));
                } catch (error) {
                    showAuthMessage(error.message);
                }
            });

            signupForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (signupPasswordInput.value.length < 6) {
                    showAuthMessage('Password must be at least 6 characters long.');
                    return;
                }
                try {
                    const userCredential = await createUserWithEmailAndPassword(auth, signupEmailInput.value, signupPasswordInput.value);
                    await updateProfile(userCredential.user, { displayName: signupNameInput.value });
                    closeModal(document.getElementById('loginModal'));
                } catch (error) {
                    showAuthMessage(error.message);
                }
            });

            onAuthStateChanged(auth, user => {
                if (user) {
                    loginNavBtn.classList.add('hidden');
                    userMonogram.classList.remove('hidden');
                    const initials = (user.displayName || user.email).split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
                    userMonogram.textContent = initials;
                } else {
                    loginNavBtn.classList.remove('hidden');
                    userMonogram.classList.add('hidden');
                    authDropdown.classList.add('hidden');
                }
            });
            
            userMonogram.addEventListener('click', (e) => {
                e.stopPropagation();
                authDropdown.classList.toggle('hidden');
            });
            
            document.addEventListener('click', (e) => {
                if (!authStatusContainer.contains(e.target)) {
                    authDropdown.classList.add('hidden');
                }
            });

            logoutBtn.addEventListener('click', () => { signOut(auth); });
            
            // Redirecting login button to open the modal instead
            loginNavBtn.addEventListener('click', (e) => {
                e.preventDefault();
                openModal('loginModal');
                showTab('login');
            });

            // --- REDIRECTION LOGIC ---
            document.getElementById('chooseAnotherDeviceBtn').addEventListener('click', () => {
                window.location.href = '/sell-device.html';
            });
        });
    </script>
</body>
</html>
